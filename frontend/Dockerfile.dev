# ============================================
# Dockerfile.dev - Frontend (SvelteKit)
# Proyecto: Moda Orgánica (Vibe Coders)
# ============================================
# 
# Propósito:
# - Entorno de desarrollo con hot-reload
# - Compatible con variables de entorno desde docker-compose
# - NO genera .env interno (usa env_file de docker-compose)
# 
# Arquitectura Metamórfica:
# - Reutilizable para cualquier proyecto SvelteKit
# - Configuración externalizada vía variables de entorno
# ============================================

# Usar imagen de Node con pnpm incluido
FROM node:18-slim

# Activar pnpm (viene incluido en corepack)
RUN corepack enable

# Establecer directorio de trabajo
WORKDIR /app

# Configurar pnpm store location
RUN pnpm config set store-dir /app/.pnpm-store

# Copiar archivos de dependencias
COPY package.json ./
COPY pnpm-lock.yaml* ./
COPY .npmrc* ./

# Instalar dependencias
# Si no existe lock file, pnpm lo generará
RUN pnpm install

# Exponer puerto de Vite dev server
EXPOSE 5173

# Comando para iniciar servidor de desarrollo
# Las variables VITE_* se inyectan desde docker-compose.yml
CMD ["pnpm", "run", "dev", "--host"]